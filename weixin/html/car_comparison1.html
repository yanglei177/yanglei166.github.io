<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="shortcut icon" href="../images/logo5.ico"/>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <title>车险比价</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/base.css">
  </head>
<body>	
    <section class="main carbj_box">  
      	<div class="caranimate">
        	<h2 class="imgsprite carimg"></h2>
            <div class="totalline">
            	<div class="statusline"></div>
                <em></em>                
            </div>
            <div class="carinfobox">填写车辆信息</div>
            <div class="carinfoarr"></div>
        </div>
        <p class="mar_t"><img src="../images/nav_tit1.png" /></p>
    </section><!-- main end --> 
    <form id="signupForm">
    <section class="fillinfo_box bg_gradient">    
    	<ul>
        	<li>
            	<div class="liimg city imgsprite"></div>
                <div class="textbox verifydes">
                	<div class="text_box">
                    	<input type="text" name="insuranceCityID" class="text textarr" placeholder="请选择投保城市" />
                        <select class="select" id="citysel"></select>
                    </div>       
                </div>
                <p class="des clr mar_l_30"></p>
            </li>
            <li>
            	<div class="liimg num imgsprite"></div>
                <div class="textbox verifydes">
                	<div class="text_box"><input type="text" name="carLicense" class="text" placeholder="请输入车牌号" /></div>
                </div>
                <p class="des clr mar_l_30"></p>
            </li>
            <li>
            	<div class="liimg name imgsprite"></div>
                <div class="textbox verifydes">
                	<div class="text_box"><input type="text" name="carOwnerName" class="text" placeholder="请输入车主姓名" /></div>
                </div>
                <p class="des clr mar_l_30"></p>
            </li>
        </ul>          	
    </section><!-- fillinfo_box end -->           
    <p><input type="submit" class="nextbtn" value="下一步" /></p>
</form>  
<div id="loadingbox"></div>    
<script src="../js/jquery-2.1.4.min.js"></script>
<script src="../js/jquery.validate.js"></script>
<script src="../js/common.js"></script>
<script type="text/javascript">
 $(function(){
	 //init city
	 baopRequest.sendData("city/init", "", function(data){
		if (data.code == 0) {
			var seldata = "<option>请选择</option>";
			var optiondata = "";
			for(var i=0;i<data.list.length;i++){
				optiondata += "<option uid='" + data.list[i].id + "'>" + data.list[i].name + "</option>"
			}
			seldata += optiondata;
			$("#citysel").append(seldata);  
		}else{
			baopRequest.bp_alert(data.message,"2500");
		}
	}); 
	
	$(".text_box .select").on("change",function(){	
	 	if($(this).val() != "请选择"){
			var uid = $(this).find("option:checked").attr("uid");
		 	$(this).prev(".textarr").html($(this).val()).prop("id",uid).removeClass("error");
		}	 					
	 });
	 
	 // init form
	 var initData = localStorage.getItem("carCompare1");
	 if(initData){
		 var data = JSON.parse(initData);
		 $("input[name=insuranceCityID]").val(data.insuranceCity);
		 $("input[name=insuranceCityID]").attr("id",data.insuranceCityID);
		 $("input[name=carLicense]").val(data.carLicense);
		 $("input[name=carOwnerName]").val(data.carOwnerName);
	 }
	 
	$("#signupForm").validate({
		rules: {
			insuranceCityID: {
				required: true
			},
			carLicense: {
				required: true,
				minlength:7,
				maxlength:7
			},
			carOwnerName: {
				required: true
			}			
		},
		messages: {
			insuranceCityID: "请选择投保城市",
			carLicense: "请输入车牌号",	
			carOwnerName: "请输入车主姓名"			
		},
		submitHandler:function(){	
			var oData = {};
			oData.insuranceCityID = $("input[name=insuranceCityID]").attr("id");
			oData.insuranceCity = $("input[name=insuranceCityID]").val();
			oData.carLicense = $("input[name=carLicense]").val();
			oData.carOwnerName = $("input[name=carOwnerName]").val();
			oData = JSON.stringify(oData);	
			localStorage.setItem("carCompare1",oData);
			location.href="car_comparison2.html";
		}
	});
 });
</script>
</body>
</html>