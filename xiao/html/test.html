<!DOCTYPE html>
<html>
        <head>
        <meta charset='utf-8'>
    <meta content="保评网" name="Keywords">
	<meta name="description" content="保评网" />	
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
        	<script type="text/javascript" src="../js/jquery-2.1.4.min.js"></script>
        	<script type="text/javascript" src="../js/lib/jweixin-1.0.0.js"></script>
       	<script type="text/javascript">
       	var targetUrl = window.location.href;
      $.ajax({
       		url:'http://test.ebaoping.com/weixin/wxapi/initConfig.html',
       		data:{debug:true,url:targetUrl},
       		dataType: 'json',
       		success:function(data){
       			wx.config(data);
       	       	wx.error(function(res){
       				//alert(JSON.stringify(res));
       				alert("----");
       	       	});
       		},
       		error: function(xhr, type){
       		    alert("----");
       		  }
       		
       	}); 
      
      
       	wx.ready(function(){
			$('#btn').tap(function (){
				wx.checkJsApi({
				    jsApiList: ['chooseImage'], // 需要检测的JS接口列表，所有JS接口列表见附录2,
				    success: function(res) {
				    	alert(JSON.stringify(res));
				    }
				});	
				}
				)
				
				
				$('#btnimg').tap(function (){
					wx.chooseImage({
					    count: 1, // 默认9
					    sizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图，默认二者都有
					    sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机，默认二者都有
					    success: function (res) {
					        var localIds = res.localIds; // 返回选定照片的本地ID列表，localId可以作为img标签的src属性显示图片
					    }
					});
				}
				)
				
	       	});
       function oauth(){
    	  $.ajax({
          		url:'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx121110e27439d1aa&redirect_uri=http%3A%2F%2Ftest.ebaoping.com%2Fweixin%2Fwxapi%2FgetWXUserinfo.html&response_type=code&scope=snsapi_base&state=abc#wechat_redirect',
          		dataType: 'jsonp',
          		jsonp: 'jsoncallback',
          		success:function(data){
          				alert(data);
          	     },
    	 	  error: function(error){
    		    //jsonp 方式此方法不被触发.原因可能是dataType如果指定为jsonp的话,就已经不是ajax事件了
    		    //请求出错处理
    		    alert("222");
    		   }
    	   });   
    	 //  location.href='https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx121110e27439d1aa&redirect_uri=http%3A%2F%2Ftest.ebaoping.com%2Fweixin%2Fwxapi%2FgetWXUserinfo.html&response_type=code&scope=snsapi_base&state=abc#wechat_redirect';
      	 }

       	</script>
        </head>
        <body>
        	<button id="btn">判断浏览器</button>
        	<button id="btnimg">选择图片</button>
        	<button id="oauth" onclick="oauth()">获取oauth地址</button>
        </body>
</html>